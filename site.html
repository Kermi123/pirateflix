<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PirateFlix - Фильм</title>
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a;
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        header {
            background: linear-gradient(90deg, #ff0066, #00ccff);
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.6);
        }
        h1 {
            margin: 0;
            font-size: 3em;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #fff;
        }
        .search-bar {
            margin: 20px auto;
            max-width: 600px;
            display: flex;
            justify-content: center;
        }
        .search-bar input {
            padding: 12px;
            width: 70%;
            border: none;
            border-radius: 5px 0 0 5px;
            font-size: 1em;
            background-color: #2c2c2c;
            color: #fff;
            outline: none;
            transition: background-color 0.3s;
        }
        .search-bar input:focus {
            background-color: #3c3c3c;
        }
        .search-bar button {
            padding: 12px 20px;
            border: none;
            border-radius: 0 5px 5px 0;
            background-color: #ff3366;
            color: #fff;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s, transform 0.2s;
        }
        .search-bar button:hover {
            background-color: #cc0052;
            transform: scale(1.05);
        }
        .container {
            max-width: 1000px;
            margin: 20px auto;
            padding: 0 20px;
        }
        .movie-card {
            background-color: #2a2a2a;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-wrap: wrap;
            gap: 25px;
        }
        .movie-poster img {
            max-width: 250px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .movie-info {
            flex: 1;
            min-width: 300px;
        }
        .movie-info h2 {
            font-size: 2.2em;
            margin: 0 0 15px;
            color: #00ccff;
            text-shadow: 0 0 5px #00ccff;
        }
        .movie-info p {
            line-height: 1.8;
            margin: 10px 0;
            color: #ccc;
        }
        .ratings {
            margin: 20px 0;
        }
        .ratings h3 {
            margin: 0 0 15px;
            color: #ff3366;
            text-shadow: 0 0 5px #ff3366;
        }
        video {
            width: 100%;
            max-width: 800px;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }
        .season-episode-selector {
            margin-top: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        .season-episode-selector select {
            padding: 10px;
            border: none;
            border-radius: 8px;
            background-color: #3c3c3c;
            color: #fff;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s, box-shadow 0.3s;
        }
        .season-episode-selector select:focus {
            background-color: #4c4c4c;
            box-shadow: 0 0 10px rgba(0, 204, 255, 0.5);
            outline: none;
        }
        .rating-section {
            margin: 30px 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .star-rating-container {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .star-rating {
            display: flex;
            gap: 5px;
        }
        .star-rating span {
            font-size: 2.5em;
            cursor: pointer;
            color: #888;
            transition: color 0.5s ease, text-shadow 0.5s ease;
            width: 30px;
            text-align: center;
        }
        .star-rating span:hover,
        .star-rating span.active {
            color: #ffd700;
            text-shadow: 0 0 15px #ffd700, 0 0 30px #ffcc00;
        }
        .star-rating span.active {
            animation: glow 1s ease-in-out infinite alternate;
        }
        @keyframes glow {
            from {
                text-shadow: 0 0 10px #ffd700, 0 0 20px #ffcc00;
            }
            to {
                text-shadow: 0 0 20px #ffd700, 0 0 40px #ffcc00;
            }
        }
        .average-rating {
            font-size: 1.5em;
            color: #00ccff;
            text-shadow: 0 0 5px #00ccff;
        }
        .vote-count {
            font-size: 1.2em;
            color: #ccc;
        }
        .vote-message {
            margin-top: 10px;
            padding: 10px;
            background-color: #3c3c3c;
            border-radius: 8px;
            color: #00ccff;
            font-size: 1.1em;
            text-shadow: 0 0 5px #00ccff;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .vote-message.show {
            opacity: 1;
        }
        .review-form {
            margin: 20px 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
            background-color: #2c2c2c;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
            transition: transform 0.3s ease;
            box-sizing: border-box;
            max-width: 600px;
        }
        .review-form:hover {
            transform: translateY(-5px);
        }
        .review-form h3 {
            margin: 0;
            color: #ff3366;
            text-shadow: 0 0 5px #ff3366;
            font-size: 1.5em;
        }
        .review-form textarea {
            width: 100%;
            box-sizing: border-box;
            padding: 12px;
            border: none;
            border-radius: 8px;
            background-color: #3c3c3c;
            color: #fff;
            font-size: 1em;
            resize: vertical;
            transition: background-color 0.3s, box-shadow 0.3s;
        }
        .review-form textarea:focus {
            background-color: #4c4c4c;
            box-shadow: 0 0 10px rgba(0, 204, 255, 0.5);
            outline: none;
        }
        .review-form button {
            align-self: flex-start;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            background-color: #ff3366;
            color: #fff;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s;
        }
        .review-form button:hover {
            background-color: #cc0052;
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(255, 51, 102, 0.5);
        }
        .reviews {
            margin-top: 20px;
            max-width: 600px;
        }
        .reviews h3 {
            margin: 0 0 15px;
            color: #ff3366;
            text-shadow: 0 0 5px #ff3366;
            font-size: 1.5em;
        }
        .review {
            background-color: #2c2c2c;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            border-left: 4px solid #00ccff;
        }
        .review:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.5);
        }
        .review p {
            margin: 0;
            color: #ddd;
            line-height: 1.6;
            font-size: 1em;
        }
        .review::before {
            content: '★';
            position: absolute;
            top: 15px;
            left: -25px;
            color: #ffd700;
            font-size: 1.2em;
            text-shadow: 0 0 5px #ffd700;
        }
        .back-button {
            margin: 20px auto;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            background-color: #ff3366;
            color: #fff;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s;
            display: block;
            text-align: center;
            text-decoration: none;
        }
        .back-button:hover {
            background-color: #cc0052;
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(255, 51, 102, 0.5);
        }
        @media (max-width: 600px) {
            h1 {
                font-size: 2em;
            }
            .movie-card {
                flex-direction: column;
                align-items: center;
            }
            .movie-poster img {
                max-width: 100%;
            }
            .star-rating span {
                font-size: 2em;
            }
            .average-rating {
                font-size: 1.2em;
            }
            .vote-count {
                font-size: 1em;
            }
            .review-form, .reviews {
                max-width: 100%;
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>PirateFlix</h1>
    </header>
    <div class="search-bar">
        <input type="text" id="searchInput" placeholder="Поиск фильмов...">
        <button onclick="searchMovies()">Найти</button>
    </div>
    <a href="home.html" class="back-button">Назад к фильмам</a>
    <div class="container">
        <div class="movie-card" id="movieCard">
            <div class="movie-poster">
                <img id="moviePoster" src="" alt="Обложка фильма">
            </div>
            <div class="movie-info">
                <h2 id="movieTitle"></h2>
                <p id="movieGenres"></p>
                <p id="movieDirector"></p>
                <p id="movieStudio"></p>
                <p id="moviePremiere"></p>
                <p id="movieDescription"></p>
                <div class="ratings" id="movieRatings"></div>
            </div>
            <div id="videoSection">
                <video id="movieVideo" controls>
                    <source src="" type="video/mp4">
                    Ваш браузер не поддерживает воспроизведение видео.
                </video>
            </div>
            <div class="rating-section">
                <div class="star-rating-container">
                    <div class="star-rating" id="starRating">
                        <span class="star" data-value="1">★</span>
                        <span class="star" data-value="2">★</span>
                        <span class="star" data-value="3">★</span>
                        <span class="star" data-value="4">★</span>
                        <span class="star" data-value="5">★</span>
                    </div>
                    <div class="rating-info">
                        <span class="average-rating"><span id="avgRating">0</span></span>
                        <span class="vote-count">(<span id="voteCount">0</span> голосов)</span>
                    </div>
                </div>
                <div class="vote-message" id="voteMessage"></div>
                <div class="review-form">
                    <h3>Оставить анонимный отзыв</h3>
                    <textarea id="reviewText" rows="4" placeholder="Ваш отзыв (анонимно)..."></textarea>
                    <button onclick="submitReview()">Отправить</button>
                </div>
                <div class="reviews" id="reviews">
                    <h3>Анонимные отзывы</h3>
                </div>
            </div>
        </div>
    </div>
    <script>
        const movies = {
            1: {
                title: "Раша Гудбай (2025)",
                poster: "https://s4.vcdn.biz/static/f/9760047691/image.jpg/pt/r375x0x4",
                genres: "Драма, Комедия",
                director: "Алексей Кирющенко",
                studio: "Квартал 95",
                premiere: "27 марта 2025",
                description: "Фильм рассказывает о Рите, жительнице Горловки, которая более 10 лет жила на оккупированной территории, поддерживая оккупантов и работая телеведущей, пропагандирующей ложные идеи об Украине. Из-за наступления Российского добровольческого корпуса она с сыном пытается эвакуироваться в Россию, но оказывается в Ужгороде. Там реальность переворачивает ее мировоззрение. Сможет ли она бросить вызов своим убеждениям?",
                video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",
                ratings: [
                    { source: "Kinobaza.com.ua", text: "Пока нет числовых рейтингов. Комментарий: «Гілляка тобі в сраку! Ми подивилися новий кварталівський фільм — і нам відібрало мову»." },
                    { source: "Filmix.my", text: "Спорный отзыв: «Фильм — однобокая провокация одной правды, разжигающая ненависть»." },
                    { source: "Kinofilms.ua", text: "Форумы пока пусты, но пользователи могут начать обсуждение." }
                ]
            },
            2: {
                title: "Два холма (2024)",
                poster: "https://kinobar.net/uploads/posts/2025-05/1746125136-1843853791.webp",
                genres: "Комедия, Фантастика",
                director: "Дмитрий Грибанов",
                studio: "START Studio",
                premiere: "15 мая 2024",
                description: "В будущем женщины создали идеальный город без мужчин. Учительница Рада живёт в этом городе, пока туда случайно не попадает мужчина, нарушая привычный порядок. Смешная и провокационная комедия о столкновении миров.",
                seasons: {
                    1: Array.from({ length: 14 }, (_, i) => ({
                        episode: i + 1,
                        video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
                    })),
                    2: Array.from({ length: 14 }, (_, i) => ({
                        episode: i + 1,
                        video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
                    })),
                    3: Array.from({ length: 4 }, (_, i) => ({
                        episode: i + 1,
                        video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
                    }))
                },
                ratings: []
            },
            3: {
                title: "Любовь под звездами (2023)",
                poster: "https://via.placeholder.com/250x375.png?text=Фильм+3",
                genres: "Романтика, Драма",
                director: "Анна Петрова",
                studio: "Романтик Филмс",
                premiere: "10 февраля 2023",
                description: "История любви, которая меняет жизни двух людей под ночным небом.",
                video: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",
                ratings: []
            }
        };

        function loadMovie() {
            const urlParams = new URLSearchParams(window.location.search);
            let movieId = urlParams.get('id') || '1';

            const movie = movies[movieId];
            if (!movie) {
                document.getElementById('movieCard').innerHTML = '<p>Фильм не найден!</p>';
                return;
            }

            document.getElementById('moviePoster').src = movie.poster;
            document.getElementById('moviePoster').alt = `Обложка ${movie.title}`;
            document.getElementById('movieTitle').textContent = movie.title;
            document.getElementById('movieGenres').innerHTML = `<strong>Жанры:</strong> ${movie.genres}`;
            document.getElementById('movieDirector').innerHTML = `<strong>Режиссер:</strong> ${movie.director}`;
            document.getElementById('movieStudio').innerHTML = `<strong>Студия:</strong> ${movie.studio}`;
            document.getElementById('moviePremiere').innerHTML = `<strong>Премьера:</strong> ${movie.premiere}`;
            document.getElementById('movieDescription').innerHTML = `<strong>Описание:</strong> ${movie.description}`;

            const videoSection = document.getElementById('videoSection');
            if (movieId === '2' && movie.seasons) {
                videoSection.innerHTML = `
                    <div class="season-episode-selector">
                        <select id="seasonSelect" onchange="updateEpisodes()">
                            <option value="1">Сезон 1</option>
                            <option value="2">Сезон 2</option>
                            <option value="3">Сезон 3</option>
                        </select>
                        <select id="episodeSelect" onchange="playEpisode()"></select>
                    </div>
                    <video id="movieVideo" controls>
                        <source src="" type="video/mp4">
                        Ваш браузер не поддерживает воспроизведение видео.
                    </video>
                `;
                updateEpisodes();
            } else {
                videoSection.innerHTML = `
                    <video id="movieVideo" controls>
                        <source src="${movie.video}" type="video/mp4">
                        Ваш браузер не поддерживает воспроизведение видео.
                    </video>
                `;
                document.getElementById('movieVideo').load();
            }

            const ratingsContainer = document.getElementById('movieRatings');
            ratingsContainer.innerHTML = '<h3>Оценки и отзывы:</h3>';
            if (movie.ratings.length) {
                movie.ratings.forEach(rating => {
                    const p = document.createElement('p');
                    p.innerHTML = `<strong>${rating.source}:</strong> ${rating.text}`;
                    ratingsContainer.appendChild(p);
                });
            } else {
                ratingsContainer.innerHTML += '<p>Пока нет отзывов от критиков.</p>';
            }

            updateAverageRating(movieId);
            const storedRatings = JSON.parse(localStorage.getItem(`ratings_${movieId}`)) || [];
            if (storedRatings.length) {
                updateStars(storedRatings[storedRatings.length - 1]);
            } else {
                updateStars(0);
            }
            displayReviews(movieId);
        }

        function updateEpisodes() {
            const seasonSelect = document.getElementById('seasonSelect');
            const episodeSelect = document.getElementById('episodeSelect');
            const season = seasonSelect.value;
            const episodes = movies['2'].seasons[season];
            episodeSelect.innerHTML = episodes.map(ep => `<option value="${ep.episode}">Серия ${ep.episode}</option>`).join('');
            playEpisode();
        }

        function playEpisode() {
            const seasonSelect = document.getElementById('seasonSelect');
            const episodeSelect = document.getElementById('episodeSelect');
            const season = seasonSelect.value;
            const episode = episodeSelect.value;
            const video = document.getElementById('movieVideo');
            const episodeData = movies['2'].seasons[season].find(ep => ep.episode == episode);
            video.querySelector('source').src = episodeData.video;
            video.load();
        }

        function searchMovies() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            if (query.includes('раша гудбай') || query.includes('rusha goodbye')) {
                window.location.href = 'site.html?id=1';
            } else if (query.includes('два холма')) {
                window.location.href = 'site.html?id=2';
            } else {
                alert('Фильм не найден! Попробуйте "Раша Гудбай" или "Два холма"');
            }
        }

        const stars = document.querySelectorAll('.star');
        const starRating = document.getElementById('starRating');
        const voteMessage = document.getElementById('voteMessage');

        function updateAverageRating(movieId) {
            const ratings = JSON.parse(localStorage.getItem(`ratings_${movieId}`)) || [];
            const avgRating = ratings.length ? (ratings.reduce((a, b) => a + b, 0) / ratings.length).toFixed(1) : 0;
            document.getElementById('avgRating').textContent = avgRating;
            document.getElementById('voteCount').textContent = ratings.length;
        }

        function updateStars(rating) {
            stars.forEach(star => {
                const starValue = parseInt(star.dataset.value);
                star.classList.toggle('active', starValue <= rating);
            });
        }

        function showVoteMessage(rating) {
            voteMessage.textContent = `Ваша оценка успешно сохранена! Вы поставили ${rating} звезд.`;
            voteMessage.classList.add('show');
            setTimeout(() => {
                voteMessage.classList.remove('show');
            }, 3000);
        }

        stars.forEach(star => {
            star.addEventListener('click', () => {
                const urlParams = new URLSearchParams(window.location.search);
                let movieId = urlParams.get('id') || '1';
                if (!movieId) return;

                const rating = parseInt(star.dataset.value);
                const ratings = JSON.parse(localStorage.getItem(`ratings_${movieId}`)) || [];
                ratings.push(rating);
                localStorage.setItem(`ratings_${movieId}`, JSON.stringify(ratings));
                updateStars(rating);
                updateAverageRating(movieId);
                showVoteMessage(rating);
            });

            star.addEventListener('mouseover', () => {
                const rating = parseInt(star.dataset.value);
                stars.forEach(s => {
                    const starValue = parseInt(s.dataset.value);
                    s.classList.toggle('active', starValue <= rating);
                });
            });

            star.addEventListener('mouseout', () => {
                stars.forEach(s => s.classList.remove('active'));
                const urlParams = new URLSearchParams(window.location.search);
                let movieId = urlParams.get('id') || '1';
                const ratings = JSON.parse(localStorage.getItem(`ratings_${movieId}`)) || [];
                if (ratings.length) {
                    updateStars(ratings[ratings.length - 1]);
                }
            });
        });

        function submitReview() {
            const urlParams = new URLSearchParams(window.location.search);
            let movieId = urlParams.get('id') || '1';
            if (!movieId) return;

            const reviewText = document.getElementById('reviewText').value.trim();
            if (reviewText) {
                const reviews = JSON.parse(localStorage.getItem(`reviews_${movieId}`)) || [];
                reviews.push(reviewText);
                localStorage.setItem(`reviews_${movieId}`, JSON.stringify(reviews));
                document.getElementById('reviewText').value = '';
                displayReviews(movieId);
            } else {
                alert('Пожалуйста, напишите отзыв перед отправкой!');
            }
        }

        function displayReviews(movieId) {
            const reviews = JSON.parse(localStorage.getItem(`reviews_${movieId}`)) || [];
            const reviewsContainer = document.getElementById('reviews');
            reviewsContainer.innerHTML = '<h3>Анонимные отзывы</h3>';
            if (reviews.length === 0) {
                const noReviews = document.createElement('p');
                noReviews.textContent = 'Пока нет отзывов. Будьте первым!';
                noReviews.style.color = '#ccc';
                reviewsContainer.appendChild(noReviews);
            } else {
                reviews.forEach(review => {
                    const reviewElement = document.createElement('div');
                    reviewElement.className = 'review';
                    const reviewText = document.createElement('p');
                    reviewText.textContent = review;
                    reviewElement.appendChild(reviewText);
                    reviewsContainer.appendChild(reviewElement);
                });
            }
        }

        loadMovie();
    </script>
</body>
</html>
